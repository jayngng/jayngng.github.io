<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Splunk - Introduction | Infomation Security - Blog</title><meta name="description" content="Introduction to Splunk  Splunk is described as a solution to aggregate, analyze and extract valuable infomration of machine data from any source.
    "><meta http-equiv="cache-control" content="max-age=29030400"><meta http-equiv="pragma" content="public"><meta name="keywords" content=""><meta name="author" content="Jay Nguyen"><meta http-equiv="Content-Language" content="en"><meta property="og:locale" content="en"><meta property="og:site_name" content="Infomation Security"><meta property="og:type" content="WebSite"><meta property="og:url" content="https://jayngng.github.io/blog/splunk-introduction/"><meta property="og:description" content="
    Blog"><meta property="og:title" content="Splunk - Introduction
  "><link rel="canonical" href="https://jayngng.github.io/blog/splunk-introduction/"><link type="application/atom+xml" rel="alternate" title="Infomation Security" href="https://jayngng.github.io/feed.xml"><link rel="icon" type="image/png" sizes="32x32" href="https://jayngng.github.io/assets/images/favicon/favicon-32x32.png"><link href="https://fonts.googleapis.com/css?family=Special+Elite" rel="stylesheet"><script defer="defer" src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script><link rel="stylesheet" href="https://jayngng.github.io/assets/css/bootstrap.css"><link rel="stylesheet" href="https://jayngng.github.io/assets/css/jektify.css"><link rel="stylesheet" href="https://jayngng.github.io/assets/css/whiteglass.css"></head><body class="body underline_links" id="top"><div class="container layout_default"><div class="row"><div class="col-lg-3 px-0 mt-0 sidebar"><div class="py-3 sticky-top flex-grow-1"><div class="pt-3 sidebar__wrapper"><div class="nav flex-lg-column mx-3 mx-lg-0"><div class="d-none d-sm-block sidebar__avatar_flip"><div class="sidebar__avatar_flip-card"><a class="sidebar__avatar_flip-front sidebar__avatar_flip-face" href="https://jayngng.github.io/"><img class="p-1 img-fluid mx-auto d-block animation__pulse sidebar_avatar_circle sidebar_avatar_background sidebar_avatar_border image_avatar" src="/assets/images/avatar/author.jpg" alt="Avatar"> </a><a class="sidebar__avatar_flip-back sidebar__avatar_flip-face" href="https://jayngng.github.io/"><img class="p-1 img-fluid mx-auto d-block animation__pulse sidebar_avatar_circle sidebar_avatar_background sidebar_avatar_border image_avatar" src="/assets/images/avatar/athor_m.png" alt="Avatar"></a></div></div><h1 class="p-2 text-center d-md-flex align-items-center mx-auto animation__sidebar-title sidebar__title"><a href="https://jayngng.github.io/" class="nav-link" style="font-size: 2.3rem">whoami</a></h1><div class="p-2 mx-3 d-md-flex flex-md-column align-items-md-start align-items-center align-items-lg-start flex-lg-column mx-auto mr-lg-3 ml-lg-3 sidebar__menu animation__sidebar-menu"><div class="my-1 d-none d-md-block mr-3 sidebar__menu-title">Menu: Blog</div><li class="mr-3 mr-lg-0 float-left float-lg-none sidebar__menu-item"><i class="mr-1 fas fa-edit"></i> <a class="sidebar__menu-link" href="https://jayngng.github.io/blog/">Blog</a></li><li class="mr-3 mr-lg-0 float-left float-lg-none sidebar__menu-item"><i class="mr-1 fas fa-tags"></i> <a class="sidebar__menu-link" href="https://jayngng.github.io/blog/tags/">Tags</a></li><li class="mr-3 mr-lg-0 float-left float-lg-none sidebar__menu-item"><i class="mr-1 fas fa-search"></i> <a class="sidebar__menu-link" href="https://jayngng.github.io/blog/search/">Search</a></li></div></div></div></div></div><div class="col-lg-9 p-0 py-4 content" id="main"><div class="px-3 mt-lg-0 layout_post animation__content" itemscope itemtype="http://schema.org/BlogPosting"><div class="p-0 p-lg-3 mb-4 layout_post__header"><h1 class="font-weight-bold layout_post__title">Splunk - Introduction</h1><div class="layout_post__date"><time class="layout_post__time"><i class="far fa-calendar-alt"></i> August 17, 2021</time></div><div class="layout_post__tags"><i class="fa fa-tags"></i>&nbsp;Tags:&nbsp; | <a class="layout_post__tags-link" href="https://jayngng.github.io/blog/tags//splunk">splunk</a> | <a class="layout_post__tags-link" href="https://jayngng.github.io/blog/tags//siem">siem</a> | <a class="layout_post__tags-link" href="https://jayngng.github.io/blog/tags//soc">soc</a> |</div><div class="layout_post__reading_time"><i class="far fa-clock"></i> Read this in "about 5 minutes".</div></div><div class="p-0 p-lg-3 mb-4 layout_post__content"><div class="d-block"><div class="py-3 row"><div class="offset-6 col-6 offset-sm-9 col-sm-3 offset-lg-10 col-lg-2"></div></div><h1 id="introduction-to-splunk">Introduction to Splunk</h1><ul><li><p>Splunk is described as a solution to aggregate, analyze and extract valuable infomration of machine data from any source.</p></li><li><p>Splunk can be used for <strong>Application Management</strong>, <strong>Operations Management</strong>, <strong>Security</strong> &amp; <strong>Compliance</strong>.</p></li><li><p>When it comes to security, Splunk can be used as a log management soultion. Splunk can enhance investigations of dynamic, multi-step attacks with detailed visualizations and even enhance an organization’s detection capabilities through User Behavior Analytics.</p></li><li><p>Splunk can swallow any data from almost any source, through both an agent-less and a forwarder approach.</p></li></ul><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/splunk/data_type.png" title="splunk/data_type.png" alt="splunk/data_type.png"></div><h4 id="splunk-architecture-overview">Splunk Architecture Overview</h4><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/splunk/architecture.png" title="splunk/architecture.png" alt="splunk/architecture.png"></div><p>Splunk architectures consist of:</p><ul><li><strong>Forwarder</strong> component:<ul><li><p><strong>Universal Forwarders</strong>: collect data from remote sources and send them to one or more Splunk Indexers. They are separate downloads that can be installed on any source, less impact on network or host performance.</p></li><li><p><strong>Heavy Forwarders</strong>: also collect data from remote sources, but they are typically used for heavy data aggregation tasks, from sources like firewalls or data routing/filtering passing points. According to Splexicon, heavy forwarders parse data beforce forwarding them and can route data based on criteria such as source or type of event. They can also index data locally while forwarding the data to another indexer. Heavy Forwarders are usually run as <strong>data collection nodes</strong> for <strong>API/scripted</strong> data access, and they are only compatible with <strong>Splunk Enterprise</strong>.</p></li><li><p><strong>Universal Forwarders</strong> is mainly used for small amount of data? while <strong>Heavy Forwarders</strong> is good for large amount of data that requires heavy filtering?</p></li></ul></li></ul><p><em>Note</em>: <strong>HTTP Event Collector</strong> (<strong>HECs</strong>) also exists to collect data directly from applications, at-scale, through a token-based JSON or raw API way.</p><ul><li><strong>Indexer</strong> component<ul><li>The Indexer <strong>processes machine data</strong>, storing the results in indexes as events, enabling fast search and analysis. As the indexer indexes data, it creates a number of files organized in sets of directories by age. Each directory contains raw data (compressed) and indexes (points to the raw data).</li></ul></li><li><strong>Seach Head</strong> component<ul><li>The <strong>Seach Head</strong> component allows users to use the Seach language to search for indexed data. It distributes user search requests to the Indexers and consolidates the results as well as extracts field value pairs from the vents to the users. Knowledge Objects on the Seach Head can be created to extract additional fields and transform the data without changing the underlying index data. It should be noted that Seach Head also provide tools to enhace the search experience such as reports, dashboards, and visualizations.</li></ul></li></ul><h4 id="splunk-apps-and-technology-add-ons-tas">Splunk Apps and Technology Add-ons (TAs)</h4><ul><li><p><strong>Splunk Apps</strong> are designed to address a wide variety of use cases and to extend the power of Splunk. Essentially, they are collections of files containing data inputs, UI elements, and/or knowledge objects. Splunk Apps also allow multiple workspaces for difference use cases/user roles to co-exist on a single Splunk instance.</p><ul><li>Apps are available at <strong>Splunkbase</strong>.</li></ul></li><li><p>Splunk Technology Add-ons abstract the collection methodology and they are typically include relevant field extractions. They also include relevant config files (props/transforms) and ancillary scripts binaries.</p></li></ul><h4 id="splunk-users-and-roles">Splunk Users and Roles</h4><ul><li>Splunk users are assigned roles which determine their capabilities and data access. There are three main roles:<ul><li><strong>admin</strong>: This role has the most capabilities assigned to it.</li><li><strong>power</strong>: This role can edit all shared objects (saved searches, etc) and alerts, tag events, and other similar tasks.</li><li><strong>user</strong>: This role can create and edit its own saved searches, run searches, edit its own references, create and edit event types. and other similar tasks.</li></ul></li></ul><h4 id="splunks-search-and-reporting-app">Splunk’s Search and Reporting App</h4><ul><li>Navigation</li></ul><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/splunk/navigation1.png" title="splunk/navigation1.png" alt="splunk/navigation1.png"></div><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/splunk/navigation2.png" title="splunk/navigation2.png" alt="splunk/navigation2.png"></div><ul><li><strong>Data Summary</strong> will summary data of hosts, sources or sourcetypes.</li></ul><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/splunk/navigation3.png" title="splunk/navigation3.png" alt="splunk/navigation3.png"></div><ul><li>This is how the <strong>Events</strong> might look like.</li></ul><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/splunk/navigation4.png" title="splunk/navigation4.png" alt="splunk/navigation4.png"></div><h6 id="splunks--search-processing-language-spl"><strong>Splunk’s Search Processing Language (SPL)</strong>:</h6><ul><li>SPL combines the best capabilities of SQL with the Unix pipeline syntax that allows you to:<ul><li>Access all data in its original format.</li><li>Optimize for time-series events.</li><li>Use the same language for visualizations.</li></ul></li></ul><p>SPL provides over 140 commands that allow user to search, correlate, analyze and visualize any data.</p><p>Example of SPL:</p><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/splunk/SPL_syntax.png" title="splunk/SPL_syntax.png" alt="splunk/SPL_syntax.png"></div><p>Searches are created based of <strong>five main components</strong>:</p><ol><li><p><strong>Search term</strong>: where you specify what you are looking for. Search terms contain keywords, phrases, Booleans, etc.</p></li><li><p><strong>Command</strong>: where you specify how you want to manipulate the result. For example, create a visualization, chart or statistic, etc…</p></li><li><p><strong>Functions</strong>: where you specify how exactly do you want to chart, compute or evaluate the results.</p></li><li><p><strong>Arguments</strong>: in case there are variables you want to apply to a function.</p></li><li><p><strong>Clauses</strong>: where you specify how exactly you want to group or rename the fields in the results.</p></li></ol><p>As you notice, there are some search string are automatically colored. The color is based on the synxtax. As the following image:</p><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/splunk/SPL_syntax2.png" title="splunk/SPL_syntax2.png" alt="splunk/SPL_syntax2.png"></div><p>Something else to consider while submitting searches is Splunk’s search modes.</p><p>There are three main search modes:</p><ul><li><p><strong>Fast Mode</strong>: Field discovery off for event searches. No event or field data for stats searches.</p></li><li><p><strong>Smart Mode</strong>: Field discovery on for event searches. No event or field data for stats searches. (recommended* for beginner)</p></li><li><p><strong>Verbose Mode</strong>: All event &amp; field data.</p></li></ul><center><script src="https://tryhackme.com/badge/44696"></script></center></div></div><div class="p-0 p-lg-3 mb-4 layout_post__footer"></div></div></div></div></div><div class="py-1 position-fixed fixed-bottom w-100 footer"><div class="container-fluid"><div class="row"><div class="text-center col-12 col-md-4"><span class="footer__copyright">Infomation Security © 2021-2023 • All right reserved.</span></div><div class="text-center col-12 col-md-4 d-none d-md-block"><span class="footer__message">Simplicity is fashionable.</span></div><div class="text-center col-12 col-md-4"><span class="footer__madeby">Made with&nbsp;<a href="https://jekyllrb.com" target="_blank">Jekyll</a>&nbsp;using&nbsp;<a href="https://github.com/williamcanin/typing-jekyll-template" target="_blank">Typing</a>&nbsp;Theme.</span></div></div></div></div><div class="d-block d-lg-none position-fixed fixed-bottom w-100 scrolltop"><div class="float-right mr-3 scrolltop__wrapper"><a class="mr-3 scrolltop__button" href="#top"><i class="fas fa-caret-up"></i></a></div></div><script type="text/javascript" src="https://jayngng.github.io/assets/vendor/js/jquery.min.js"></script><script type="text/javascript" src="https://jayngng.github.io/assets/vendor/js/popper.min.js"></script><script type="text/javascript" src="https://jayngng.github.io/assets/vendor/js/bootstrap.min.js"></script><script type="text/javascript" src="https://jayngng.github.io/assets/vendor/js/simple-jekyll-search.min.js"></script><script type="text/javascript" src="https://jayngng.github.io/assets/js/global.js"></script><script type="text/javascript" src="https://jayngng.github.io/assets/js/post.js"></script><script src="https://jayngng.github.io/assets/vendor/jektify/js/jektify.min.js"></script></body><script id="dsq-count-scr" src="https://.disqus.com/count.js" async></script></html>