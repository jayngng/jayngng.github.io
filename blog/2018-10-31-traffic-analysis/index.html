<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1"><title>2018-10-31 - Traffic Analysis | Infomation Security - Blog</title><meta name="description" content="DescriptionTraffic analysis on 2018-10-31.
    "><meta http-equiv="cache-control" content="max-age=29030400"><meta http-equiv="pragma" content="public"><meta name="keywords" content=""><meta name="author" content="Jay Nguyen"><meta http-equiv="Content-Language" content="en"><meta property="og:locale" content="en"><meta property="og:site_name" content="Infomation Security"><meta property="og:type" content="WebSite"><meta property="og:url" content="https://jayngng.github.io/blog/2018-10-31-traffic-analysis/"><meta property="og:description" content="
    Blog"><meta property="og:title" content="2018-10-31 - Traffic Analysis
  "><link rel="canonical" href="https://jayngng.github.io/blog/2018-10-31-traffic-analysis/"><link type="application/atom+xml" rel="alternate" title="Infomation Security" href="https://jayngng.github.io/feed.xml"><link rel="icon" type="image/png" sizes="32x32" href="https://jayngng.github.io/assets/images/favicon/favicon-32x32.png"><link href="https://fonts.googleapis.com/css?family=Special+Elite" rel="stylesheet"><script defer="defer" src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script><link rel="stylesheet" href="https://jayngng.github.io/assets/css/bootstrap.css"><link rel="stylesheet" href="https://jayngng.github.io/assets/css/jektify.css"><link rel="stylesheet" href="https://jayngng.github.io/assets/css/whiteglass.css"></head><body class="body underline_links" id="top"><div class="container layout_default"><div class="row"><div class="col-lg-3 px-0 mt-0 sidebar"><div class="py-3 sticky-top flex-grow-1"><div class="pt-3 sidebar__wrapper"><div class="nav flex-lg-column mx-3 mx-lg-0"><div class="d-none d-sm-block sidebar__avatar_flip"><div class="sidebar__avatar_flip-card"><a class="sidebar__avatar_flip-front sidebar__avatar_flip-face" href="https://jayngng.github.io/"><img class="p-1 img-fluid mx-auto d-block animation__pulse sidebar_avatar_circle sidebar_avatar_background sidebar_avatar_border image_avatar" src="/assets/images/avatar/author.jpg" alt="Avatar"> </a><a class="sidebar__avatar_flip-back sidebar__avatar_flip-face" href="https://jayngng.github.io/"><img class="p-1 img-fluid mx-auto d-block animation__pulse sidebar_avatar_circle sidebar_avatar_background sidebar_avatar_border image_avatar" src="/assets/images/avatar/athor_m.png" alt="Avatar"></a></div></div><h1 class="p-2 text-center d-md-flex align-items-center mx-auto animation__sidebar-title sidebar__title"><a href="https://jayngng.github.io/" class="nav-link" style="font-size: 2.3rem">whoami</a></h1><div class="p-2 mx-3 d-md-flex flex-md-column align-items-md-start align-items-center align-items-lg-start flex-lg-column mx-auto mr-lg-3 ml-lg-3 sidebar__menu animation__sidebar-menu"><div class="my-1 d-none d-md-block mr-3 sidebar__menu-title">Menu: Blog</div><li class="mr-3 mr-lg-0 float-left float-lg-none sidebar__menu-item"><i class="mr-1 fas fa-edit"></i> <a class="sidebar__menu-link" href="https://jayngng.github.io/blog/">Blog</a></li><li class="mr-3 mr-lg-0 float-left float-lg-none sidebar__menu-item"><i class="mr-1 fas fa-tags"></i> <a class="sidebar__menu-link" href="https://jayngng.github.io/blog/tags/">Tags</a></li><li class="mr-3 mr-lg-0 float-left float-lg-none sidebar__menu-item"><i class="mr-1 fas fa-search"></i> <a class="sidebar__menu-link" href="https://jayngng.github.io/blog/search/">Search</a></li></div></div></div></div></div><div class="col-lg-9 p-0 py-4 content" id="main"><div class="px-3 mt-lg-0 layout_post animation__content" itemscope itemtype="http://schema.org/BlogPosting"><div class="p-0 p-lg-3 mb-4 layout_post__header"><h1 class="font-weight-bold layout_post__title">2018-10-31 - Traffic Analysis</h1><div class="layout_post__date"><time class="layout_post__time"><i class="far fa-calendar-alt"></i> October 26, 2021</time></div><div class="layout_post__tags"><i class="fa fa-tags"></i>&nbsp;Tags:&nbsp; | <a class="layout_post__tags-link" href="https://jayngng.github.io/blog/tags//soc">soc</a> | <a class="layout_post__tags-link" href="https://jayngng.github.io/blog/tags//traffic_analysis">traffic_analysis</a> | <a class="layout_post__tags-link" href="https://jayngng.github.io/blog/tags//blueteam">blueteam</a> |</div><div class="layout_post__reading_time"><i class="far fa-clock"></i> Read this in "about 3 minutes".</div></div><div class="p-0 p-lg-3 mb-4 layout_post__content"><div class="d-block"><div class="py-3 row"><div class="offset-6 col-6 offset-sm-9 col-sm-3 offset-lg-10 col-lg-2"></div></div><h2 id="description"><strong>Description</strong></h2><p>Traffic analysis on 2018-10-31.</p><p>-&gt; Link to the <code class="language-plaintext highlighter-rouge">pcap</code>: <a href="https://www.malware-traffic-analysis.net/2018/10/31/2018-10-31-traffic-analysis-exercise.pcap.zip">here</a>.</p><p>-&gt; Password: <code class="language-plaintext highlighter-rouge">infected</code>.</p><p><strong>Credit:</strong> www.malware-traffic-analysis.net</p><p><br></p><h2 id="executive-summary"><strong>Executive Summary</strong></h2><p>On 2018-10-31 15:34:11 UTC, Ichabod Crane’s computer was infected via opening and executing a Trickbot malware. After the incident was reported, the SOC team immediately contacted with Ichabod Crane to start investigating the incident.</p><p><br></p><h2 id="infection-overview"><strong>Infection Overview</strong></h2><p><strong>Date and time of the activity (in GMT or UTC)</strong></p><ul><li><code class="language-plaintext highlighter-rouge">2018/10/31 15:34:11 PM</code></li></ul><p><strong>The account name or username from the infected Windows computer</strong></p><ul><li><code class="language-plaintext highlighter-rouge">ichabod.crane</code></li></ul><p><strong>The host name of the infected Windows computer</strong></p><ul><li><code class="language-plaintext highlighter-rouge">HEADLESS-PC</code></li></ul><p><strong>The MAC address of the infected Windows computer</strong></p><ul><li><code class="language-plaintext highlighter-rouge">HewlettP_2a:96:0a (00:50:8b:2a:96:0a)</code></li></ul><p><strong>SHA256 file hashes for any malware from the pcap</strong></p><ul><li><code class="language-plaintext highlighter-rouge">396223eeec49493a52dd9d8ba5348a332bf064483a358db79d8bb8d22e6eb62c</code></li></ul><p><strong>What type of infection this is</strong></p><ul><li><code class="language-plaintext highlighter-rouge">Trickbot Malware</code></li></ul><p><br></p><h2 id="traffic-analysis"><strong>Traffic Analysis</strong></h2><p>Firstly, we’re recommended to inspect the <strong>Statistics</strong> section for a better vision over the traffic.</p><p>Within the <code class="language-plaintext highlighter-rouge">Wireshark</code> interface, we navigate to <strong>Statistics</strong> -&gt; <strong>Protocol Hierarchy</strong> to inspect common traffic protocols.</p><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/20181031/1.png" title="20181031/1.png" alt="20181031/1.png"></div><p>As we can see, most communications took place under the <code class="language-plaintext highlighter-rouge">TCP</code> protocol.</p><p>Let’s also look at the “ipv4 addresses” statistic. To do so, we navigate to <strong>Statistics</strong> -&gt; <strong>IP Addresses</strong></p><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/20181031/2.png" title="20181031/2.png" alt="20181031/2.png"></div><p>Those highlighted ip addresses account for a large portion of traffic, which is prioritized as our target of investigation. The others are also worth to check out.</p><p>We’ll begin with <code class="language-plaintext highlighter-rouge">http</code> traffic as usual.</p><ul><li>Search query: <code class="language-plaintext highlighter-rouge">http.request</code></li><li>Then <code class="language-plaintext highlighter-rouge">Follow TCP Stream</code> of the packet <code class="language-plaintext highlighter-rouge">679</code>.</li></ul><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/20181031/3.png" title="20181031/3.png" alt="20181031/3.png"></div><p>We should see something similar to the follows:</p><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/20181031/4.png" title="20181031/4.png" alt="20181031/4.png"></div><p>The <code class="language-plaintext highlighter-rouge">10.100.9.107</code> address downloaded a Windows executable from an unknown source.</p><p>If we export the executable and submit it onto <a href="https://www.virustotal.com/gui/file/396223eeec49493a52dd9d8ba5348a332bf064483a358db79d8bb8d22e6eb62c">VirusTotal</a> …</p><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/20181031/5.png" title="20181031/5.png" alt="20181031/5.png"></div><p>The file is flagged as <code class="language-plaintext highlighter-rouge">Trickbot</code> malware by multiple vendors!.</p><p>Now, we can safely conclude that <code class="language-plaintext highlighter-rouge">10.100.9.107</code> is the victim of malware attack.</p><p>Additionally, we also discover various post-exploitation activities being done by attackers.</p><p>For instance, the communications with CnC for data exfiltration.</p><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/20181031/6.png" title="20181031/6.png" alt="20181031/6.png"></div><p>Inspecting one of the <code class="language-plaintext highlighter-rouge">POST</code> requests, we can see, i.e. <strong>system process</strong> is exfiltrated.</p><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/20181031/7.png" title="20181031/7.png" alt="20181031/7.png"></div><p>Others, attackers pivot and exploit the <code class="language-plaintext highlighter-rouge">EternalBlue</code> vulnerability on <code class="language-plaintext highlighter-rouge">10.100.9.4</code>, demonstrated via <code class="language-plaintext highlighter-rouge">TCP stream 69</code>.</p><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/20181031/8.png" title="20181031/8.png" alt="20181031/8.png"></div><p><code class="language-plaintext highlighter-rouge">Security Onion</code> is also a great way to start. In the below image, we can efficiently hunt for threats based on the alert rules from <code class="language-plaintext highlighter-rouge">suricata</code> or <code class="language-plaintext highlighter-rouge">zeek</code>.</p><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/20181031/9.png" title="20181031/9.png" alt="20181031/9.png"></div><p>Basically, above information is adequate to conclude that organization’s network is attacked, further actions needed to keep attackers away from critical infrastructures.</p><p><br></p><center><script src="https://tryhackme.com/badge/44696"></script></center></div></div><div class="p-0 p-lg-3 mb-4 layout_post__footer"></div></div></div></div></div><div class="py-1 position-fixed fixed-bottom w-100 footer"><div class="container-fluid"><div class="row"><div class="text-center col-12 col-md-4"><span class="footer__copyright">Infomation Security © 2021-2023 • All right reserved.</span></div><div class="text-center col-12 col-md-4 d-none d-md-block"><span class="footer__message">Simplicity is fashionable.</span></div><div class="text-center col-12 col-md-4"><span class="footer__madeby">Made with&nbsp;<a href="https://jekyllrb.com" target="_blank">Jekyll</a>&nbsp;using&nbsp;<a href="https://github.com/williamcanin/typing-jekyll-template" target="_blank">Typing</a>&nbsp;Theme.</span></div></div></div></div><div class="d-block d-lg-none position-fixed fixed-bottom w-100 scrolltop"><div class="float-right mr-3 scrolltop__wrapper"><a class="mr-3 scrolltop__button" href="#top"><i class="fas fa-caret-up"></i></a></div></div><script type="text/javascript" src="https://jayngng.github.io/assets/vendor/js/jquery.min.js"></script><script type="text/javascript" src="https://jayngng.github.io/assets/vendor/js/popper.min.js"></script><script type="text/javascript" src="https://jayngng.github.io/assets/vendor/js/bootstrap.min.js"></script><script type="text/javascript" src="https://jayngng.github.io/assets/vendor/js/simple-jekyll-search.min.js"></script><script type="text/javascript" src="https://jayngng.github.io/assets/js/global.js"></script><script type="text/javascript" src="https://jayngng.github.io/assets/js/post.js"></script><script src="https://jayngng.github.io/assets/vendor/jektify/js/jektify.min.js"></script></body><script id="dsq-count-scr" src="https://.disqus.com/count.js" async></script></html>