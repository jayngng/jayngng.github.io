<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Cyber@ANZ - Digital Forensics | Infomation Security - Blog</title><meta name="description" content="Task Description
    "><meta http-equiv="cache-control" content="max-age=29030400"><meta http-equiv="pragma" content="public"><meta name="keywords" content=""><meta name="author" content="Jay Nguyen"><meta http-equiv="Content-Language" content="en"><meta property="og:locale" content="en"><meta property="og:site_name" content="Infomation Security"><meta property="og:type" content="WebSite"><meta property="og:url" content="https://jayngng.github.io/blog/cyberanz-digital-forensics/"><meta property="og:description" content="
    Blog"><meta property="og:title" content="Cyber@ANZ - Digital Forensics
  "><link rel="canonical" href="https://jayngng.github.io/blog/cyberanz-digital-forensics/"><link type="application/atom+xml" rel="alternate" title="Infomation Security" href="https://jayngng.github.io/feed.xml"><link rel="icon" type="image/png" sizes="32x32" href="https://jayngng.github.io/assets/images/favicon/favicon-32x32.png"><link href="https://fonts.googleapis.com/css?family=Special+Elite" rel="stylesheet"><script defer="defer" src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script><link rel="stylesheet" href="https://jayngng.github.io/assets/css/bootstrap.css"><link rel="stylesheet" href="https://jayngng.github.io/assets/css/jektify.css"><link rel="stylesheet" href="https://jayngng.github.io/assets/css/whiteglass.css"></head><body class="body underline_links" id="top"><div class="container layout_default"><div class="row"><div class="col-lg-3 px-0 mt-0 sidebar"><div class="py-3 sticky-top flex-grow-1"><div class="pt-3 sidebar__wrapper"><div class="nav flex-lg-column mx-3 mx-lg-0"><div class="d-none d-sm-block sidebar__avatar_flip"><div class="sidebar__avatar_flip-card"><a class="sidebar__avatar_flip-front sidebar__avatar_flip-face" href="https://jayngng.github.io/"><img class="p-1 img-fluid mx-auto d-block animation__pulse sidebar_avatar_circle sidebar_avatar_background sidebar_avatar_border image_avatar" src="/assets/images/avatar/author.jpg" alt="Avatar"> </a><a class="sidebar__avatar_flip-back sidebar__avatar_flip-face" href="https://jayngng.github.io/"><img class="p-1 img-fluid mx-auto d-block animation__pulse sidebar_avatar_circle sidebar_avatar_background sidebar_avatar_border image_avatar" src="/assets/images/avatar/athor_m.png" alt="Avatar"></a></div></div><h1 class="p-2 text-center d-md-flex align-items-center mx-auto animation__sidebar-title sidebar__title"><a href="https://jayngng.github.io/" class="nav-link" style="font-size: 2.3rem">whoami</a></h1><div class="p-2 mx-3 d-md-flex flex-md-column align-items-md-start align-items-center align-items-lg-start flex-lg-column mx-auto mr-lg-3 ml-lg-3 sidebar__menu animation__sidebar-menu"><div class="my-1 d-none d-md-block mr-3 sidebar__menu-title">Menu: Blog</div><li class="mr-3 mr-lg-0 float-left float-lg-none sidebar__menu-item"><i class="mr-1 fas fa-edit"></i> <a class="sidebar__menu-link" href="https://jayngng.github.io/blog/">Blog</a></li><li class="mr-3 mr-lg-0 float-left float-lg-none sidebar__menu-item"><i class="mr-1 fas fa-tags"></i> <a class="sidebar__menu-link" href="https://jayngng.github.io/blog/tags/">Tags</a></li><li class="mr-3 mr-lg-0 float-left float-lg-none sidebar__menu-item"><i class="mr-1 fas fa-search"></i> <a class="sidebar__menu-link" href="https://jayngng.github.io/blog/search/">Search</a></li></div></div></div></div></div><div class="col-lg-9 p-0 py-4 content" id="main"><div class="px-3 mt-lg-0 layout_post animation__content" itemscope itemtype="http://schema.org/BlogPosting"><div class="p-0 p-lg-3 mb-4 layout_post__header"><h1 class="font-weight-bold layout_post__title">Cyber@ANZ - Digital Forensics</h1><div class="layout_post__date"><time class="layout_post__time"><i class="far fa-calendar-alt"></i> September 23, 2021</time></div><div class="layout_post__tags"><i class="fa fa-tags"></i>&nbsp;Tags:&nbsp; | <a class="layout_post__tags-link" href="https://jayngng.github.io/blog/tags//traffic_analysis">traffic_analysis</a> | <a class="layout_post__tags-link" href="https://jayngng.github.io/blog/tags//digital_forensics">digital_forensics</a> | <a class="layout_post__tags-link" href="https://jayngng.github.io/blog/tags//blue">blue</a> |</div><div class="layout_post__reading_time"><i class="far fa-clock"></i> Read this in "about 6 minutes".</div></div><div class="p-0 p-lg-3 mb-4 layout_post__content"><div class="d-block"><div class="py-3 row"><div class="offset-6 col-6 offset-sm-9 col-sm-3 offset-lg-10 col-lg-2"></div></div><h2 id="task-description"><strong>Task Description</strong></h2><p>Suspicious network activity has been detected coming from a user on the ANZ network.</p><p>A laptop has been flagged up on our security systems due to suspicious internet traffic, and we need you to investigate the network traffic in order to establish what the user accessed and downloaded.</p><p>Your task is to examine their network activity and gather what information you can on what images they viewed and what files they accessed.</p><p>You have been provided with a packet capture file (pcap) containing all their recent network activity. There may be a number of artifacts contained within the packet capture file, and you will be expected to identify and report as many as possible.</p><p><strong>You must provide a report on everything you found, and document what processes / steps you followed to achieve this.</strong></p><p>Download Packet: <a href="https://cdn.theforage.com/vinternships/companyassets/AKkAyEwWc8wjPxx9n/Digital_Investigation%20Task%20(pcap%20file).pcapng">here</a>.</p><p><br></p><h2 id="solutions"><strong>Solutions</strong></h2><h4 id="packet-analyses"><strong>Packet Analyses</strong></h4><p>I utilized the network analysis tool called <code class="language-plaintext highlighter-rouge">Wireshark</code> to read the provided packet capture file.</p><p>Analysing the traffic, I discovered that most communications occurred via HTTP service, so I decided to filter the HTTP traffic using the <code class="language-plaintext highlighter-rouge">http.request</code> query.</p><p>As I further investigated the communications, I found out some interesting “<code class="language-plaintext highlighter-rouge">GET</code>” requests demonstrated by the following image.</p><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/1.png" title="ANZ_Digital_Forensics/1.png" alt="ANZ_Digital_Forensics/1.png"></div><p>I then took the next step by downloading those images.</p><p><code class="language-plaintext highlighter-rouge">Wireshark</code> provides a capability to extract the objects in the HTTP traffic.</p><ol><li>From Wireshark, I navigated to <strong><em>File</em></strong> -&gt; <strong><em>Export Objects</em></strong> -&gt; <strong><em>HTTP</em></strong>.</li><li>There is a new Windows popped up -&gt; Click <strong><em>Save All</em></strong> -&gt; Pick a desired folder-&gt; <strong><em>Choose</em></strong>.</li></ol><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/2.png" title="ANZ_Digital_Forensics/2.png" alt="ANZ_Digital_Forensics/2.png"></div><p>Here are the <code class="language-plaintext highlighter-rouge">md5</code> hashes of those images after they were downloaded:</p><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/3.png" title="ANZ_Digital_Forensics/3.png" alt="ANZ_Digital_Forensics/3.png"></div><p>Analysing those images, I was able to spot a few dubious points.</p><h4 id="sub-task-1"><strong>Sub-task 1</strong></h4><ul><li><p><code class="language-plaintext highlighter-rouge">anz-logo.jpg</code> and <code class="language-plaintext highlighter-rouge">bank-card.jpg</code> are two images that show up in the users network traffic. Opened those images with an Image Viewer application, I obtained the following results.</p></li><li><p><code class="language-plaintext highlighter-rouge">anz-logo.jpg</code></p></li></ul><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/4.png" title="ANZ_Digital_Forensics/4.png" alt="ANZ_Digital_Forensics/4.png"></div><ul><li><code class="language-plaintext highlighter-rouge">bank-card.jpg</code></li></ul><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/5.png" title="ANZ_Digital_Forensics/5.png" alt="ANZ_Digital_Forensics/5.png"></div><h4 id="sub-task-2"><strong>Sub-task 2</strong></h4><ul><li>The network traffic for the images <code class="language-plaintext highlighter-rouge">ANZ1.jpg</code> and <code class="language-plaintext highlighter-rouge">ANZ2.jpg</code> is more than it appears.</li><li>Employing a tool called <code class="language-plaintext highlighter-rouge">strings</code> against the <code class="language-plaintext highlighter-rouge">ANZ1.jpg</code>, I discovered a hidden message.</li></ul><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/6.png" title="ANZ_Digital_Forensics/6.png" alt="ANZ_Digital_Forensics/6.png"></div><p>I achieved the same result by inspecting the <code class="language-plaintext highlighter-rouge">tcp stream 14”</code>.</p><p>The Wireshark filter query is: <code class="language-plaintext highlighter-rouge">tcp.stream eq 14</code> -&gt; <code class="language-plaintext highlighter-rouge">Follow TCP Stream</code>. At the end of the stream, the hidden message showed up.</p><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/7.png" title="ANZ_Digital_Forensics/7.png" alt="ANZ_Digital_Forensics/7.png"></div><p>Open the image with <code class="language-plaintext highlighter-rouge">HxD</code> application, I could also retain the same output.</p><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/hxd.png" title="ANZ_Digital_Forensics/hxd.png" alt="ANZ_Digital_Forensics/hxd.png"></div><p>I followed the same techniques with the <code class="language-plaintext highlighter-rouge">ANZ2.jpg</code> image and managed to allocate the hidden messages shown as below.</p><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/8.png" title="ANZ_Digital_Forensics/8.png" alt="ANZ_Digital_Forensics/8.png"></div><h4 id="sub-task-3"><strong>Sub-task 3</strong></h4><ul><li>The <code class="language-plaintext highlighter-rouge">how-to-commit-crimes.docx</code> file type is <code class="language-plaintext highlighter-rouge">ASCII</code>. I could confirm that with the <code class="language-plaintext highlighter-rouge">file</code> command.</li></ul><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/9.png" title="ANZ_Digital_Forensics/9.png" alt="ANZ_Digital_Forensics/9.png"></div><p>Here is how the content looks like on the wire.</p><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/10.png" title="ANZ_Digital_Forensics/10.png" alt="ANZ_Digital_Forensics/10.png"></div><h4 id="sub-task-4"><strong>Sub-task 4</strong></h4><ul><li>The user accessed three pdf documents: <code class="language-plaintext highlighter-rouge">ANZ_Document.pdf</code>, <code class="language-plaintext highlighter-rouge">ANZ_Document2.pdf</code> and <code class="language-plaintext highlighter-rouge">evil.pdf</code>. Inspecting those <code class="language-plaintext highlighter-rouge">.pdf</code> respectively …</li><li><code class="language-plaintext highlighter-rouge">ANZ_Document.pdf</code></li></ul><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/11.png" title="ANZ_Digital_Forensics/11.png" alt="ANZ_Digital_Forensics/11.png"></div><ul><li><code class="language-plaintext highlighter-rouge">ANZ_Document2.pdf</code></li></ul><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/12.png" title="ANZ_Digital_Forensics/12.png" alt="ANZ_Digital_Forensics/12.png"></div><ul><li>The <code class="language-plaintext highlighter-rouge">evil.pdf</code> file is suspicious with the following contents.</li></ul><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/13.png" title="ANZ_Digital_Forensics/13.png" alt="ANZ_Digital_Forensics/13.png"></div><h4 id="sub-task-5"><strong>Sub-task 5</strong></h4><ul><li>The <code class="language-plaintext highlighter-rouge">hiddenmessage2.txt</code> file is actually a JPG image. This could be confirmed with the <code class="language-plaintext highlighter-rouge">JFIF</code> file signature.</li></ul><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/14.png" title="ANZ_Digital_Forensics/14.png" alt="ANZ_Digital_Forensics/14.png"></div><p>By changing the file extension to <code class="language-plaintext highlighter-rouge">hiddenmessage2.jpg</code>. Here is how it looks like.</p><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/15.png" title="ANZ_Digital_Forensics/15.png" alt="ANZ_Digital_Forensics/15.png"></div><h4 id="sub-task-6"><strong>Sub-task 6</strong></h4><ul><li>A hidden image is embedded in the <code class="language-plaintext highlighter-rouge">atm-image.jpg</code>. I could confirm that by inspecting the file stream with <code class="language-plaintext highlighter-rouge">Wireshark</code>.</li></ul><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/16.png" title="ANZ_Digital_Forensics/16.png" alt="ANZ_Digital_Forensics/16.png"></div><ul><li>Scrolling down a little bit, I found the second <code class="language-plaintext highlighter-rouge">JFIF</code> file signature.</li></ul><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/17.png" title="ANZ_Digital_Forensics/17.png" alt="ANZ_Digital_Forensics/17.png"></div><ul><li>Extracting the second image with <code class="language-plaintext highlighter-rouge">foremost</code>.</li></ul><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/18.png" title="ANZ_Digital_Forensics/18.png" alt="ANZ_Digital_Forensics/18.png"></div><ul><li>Here is how it looks like.</li></ul><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/19.png" title="ANZ_Digital_Forensics/19.png" alt="ANZ_Digital_Forensics/19.png"></div><h4 id="sub-task-7"><strong>Sub-task 7</strong></h4><ul><li>The <code class="language-plaintext highlighter-rouge">broken.png</code> file content is <code class="language-plaintext highlighter-rouge">base64-encoded</code>. I decoded the content, and took a look at the file header, it appears to be a <code class="language-plaintext highlighter-rouge">PNG</code> image.</li></ul><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/20.png" title="ANZ_Digital_Forensics/20.png" alt="ANZ_Digital_Forensics/20.png"></div><ul><li>I simply redirected the decoded content of <code class="language-plaintext highlighter-rouge">broken.png</code> to <code class="language-plaintext highlighter-rouge">broken_recover.png</code>.</li><li>Here is how the <code class="language-plaintext highlighter-rouge">broken_recover.png</code> image looks like when its recovered.</li></ul><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/21.png" title="ANZ_Digital_Forensics/21.png" alt="ANZ_Digital_Forensics/21.png"></div><h4 id="sub-task-8"><strong>Sub-task 8</strong></h4><ul><li>The <code class="language-plaintext highlighter-rouge">securepdf.pdf</code> is a actually a <code class="language-plaintext highlighter-rouge">.zip</code> file. Once again, I could state that by checking the file type with <code class="language-plaintext highlighter-rouge">file</code>.</li></ul><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/22.png" title="ANZ_Digital_Forensics/22.png" alt="ANZ_Digital_Forensics/22.png"></div><ul><li>Extract the zip, I was prompted to enter a password.</li></ul><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/23.png" title="ANZ_Digital_Forensics/23.png" alt="ANZ_Digital_Forensics/23.png"></div><ul><li>Crack the zip with <code class="language-plaintext highlighter-rouge">fcrackzip</code>, the yielded password is <code class="language-plaintext highlighter-rouge">secure</code>.</li></ul><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/24.png" title="ANZ_Digital_Forensics/24.png" alt="ANZ_Digital_Forensics/24.png"></div><ul><li>Extract the <code class="language-plaintext highlighter-rouge">zip</code> with the password of <code class="language-plaintext highlighter-rouge">secure</code>, I managed to recover the <code class="language-plaintext highlighter-rouge">rawpdf.pdf</code>.</li></ul><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/25.png" title="ANZ_Digital_Forensics/25.png" alt="ANZ_Digital_Forensics/25.png"></div><ul><li>Here is how the file looks like when its recovered.</li></ul><div class="row imager__plugin"><img class="img-fluid mx-auto d-block" src="/assets/images/posts/ANZ_Digital_Forensics/26.png" title="ANZ_Digital_Forensics/26.png" alt="ANZ_Digital_Forensics/26.png"></div><center><script src="https://tryhackme.com/badge/44696"></script></center></div></div><div class="p-0 p-lg-3 mb-4 layout_post__footer"></div></div></div></div></div><div class="py-1 position-fixed fixed-bottom w-100 footer"><div class="container-fluid"><div class="row"><div class="text-center col-12 col-md-4"><span class="footer__copyright">Infomation Security © 2021-2023 • All right reserved.</span></div><div class="text-center col-12 col-md-4 d-none d-md-block"><span class="footer__message">Simplicity is fashionable.</span></div><div class="text-center col-12 col-md-4"><span class="footer__madeby">Made with&nbsp;<a href="https://jekyllrb.com" target="_blank">Jekyll</a>&nbsp;using&nbsp;<a href="https://github.com/williamcanin/typing-jekyll-template" target="_blank">Typing</a>&nbsp;Theme.</span></div></div></div></div><div class="d-block d-lg-none position-fixed fixed-bottom w-100 scrolltop"><div class="float-right mr-3 scrolltop__wrapper"><a class="mr-3 scrolltop__button" href="#top"><i class="fas fa-caret-up"></i></a></div></div><script type="text/javascript" src="https://jayngng.github.io/assets/vendor/js/jquery.min.js"></script><script type="text/javascript" src="https://jayngng.github.io/assets/vendor/js/popper.min.js"></script><script type="text/javascript" src="https://jayngng.github.io/assets/vendor/js/bootstrap.min.js"></script><script type="text/javascript" src="https://jayngng.github.io/assets/vendor/js/simple-jekyll-search.min.js"></script><script type="text/javascript" src="https://jayngng.github.io/assets/js/global.js"></script><script type="text/javascript" src="https://jayngng.github.io/assets/js/post.js"></script><script src="https://jayngng.github.io/assets/vendor/jektify/js/jektify.min.js"></script></body><script id="dsq-count-scr" src="https://.disqus.com/count.js" async></script></html>